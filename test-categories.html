<!DOCTYPE html>
<html>
<head>
    <title>Test Categories Loading</title>
</head>
<body>
    <h1>Test Categories Loading</h1>
    
    <div>
        <label for="category_id">Danh mục (Tùy chọn)</label>
        <select id="category_id">
            <option value="">-- Chọn danh mục --</option>
            <!-- Danh mục sẽ được load từ API -->
        </select>
    </div>
    
    <div id="debug"></div>

    <script>
        async function loadCategories() {
            try {
                console.log("Loading categories...");
                document.getElementById("debug").innerHTML += "<p>Loading categories...</p>";
                
                const response = await fetch("/api/categories");
                console.log("Categories response status:", response.status);
                document.getElementById("debug").innerHTML += `<p>Response status: ${response.status}</p>`;
                
                if (response.ok) {
                    const categories = await response.json();
                    console.log("Categories data:", categories);
                    document.getElementById("debug").innerHTML += `<p>Found ${categories.length} categories</p>`;
                    
                    const categorySelect = document.getElementById("category_id");
                    
                    // API trả về trực tiếp mảng categories
                    categories.forEach(category => {
                        const option = document.createElement("option");
                        option.value = category.category_id;
                        option.textContent = category.category_name;
                        categorySelect.appendChild(option);
                        console.log(`Added: ${category.category_name}`);
                    });
                    
                    document.getElementById("debug").innerHTML += `<p>✅ Loaded ${categories.length} categories successfully!</p>`;
                } else {
                    console.error("Failed to fetch categories:", response.status);
                    document.getElementById("debug").innerHTML += `<p>❌ Failed: ${response.status}</p>`;
                }
            } catch (error) {
                console.error("Error loading categories:", error);
                document.getElementById("debug").innerHTML += `<p>❌ Error: ${error.message}</p>`;
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            console.log("DOM loaded, testing categories...");
            loadCategories();
        });
    </script>
</body>
</html>
